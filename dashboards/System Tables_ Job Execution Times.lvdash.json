{"datasets":[{"name":"06c7f623","displayName":"Jobs timeline","query":"WITH jobs AS (\n    SELECT job_id,\n    COUNT(DISTINCT run_id) num_runs\n    FROM finops.system_lookups.v_job_runs\n    WHERE\n        usage_date BETWEEN :from_date AND :to_date\n    GROUP BY job_id\n    ORDER BY count(run_id) DESC\n    LIMIT :top_n\n)    \nSELECT\n    jr.job_id,\n    jr.job_name,\n    jr.usage_date,\n    jobs.num_runs,\n    DATE_TRUNC('MINUTE',jr.usage_ts) usage_minute,\n    jr.result_state,\n    avg(jr.execution_duration / 1000) duration_secs\nFROM\n    finops.system_lookups.v_job_runs jr\nINNER JOIN jobs ON jobs.job_id = jr.job_id  -- Modified join condition\nWHERE\n    jr.usage_date BETWEEN :from_date AND :to_date\nGROUP BY\n    jr.job_id,\n    jr.job_name,\n    jobs.num_runs,\n    jr.usage_date,\n    jr.result_state,\n    DATE_TRUNC('MINUTE',jr.usage_ts);","parameters":[{"displayName":"from_date","keyword":"from_date","dataType":"DATE","defaultSelection":{"values":{"dataType":"DATE","values":[{"value":"now-30d/d"}]}}},{"displayName":"to_date","keyword":"to_date","dataType":"DATE","defaultSelection":{"values":{"dataType":"DATE","values":[{"value":"now/d"}]}}},{"displayName":"Top","keyword":"top_n","dataType":"INTEGER","defaultSelection":{"values":{"dataType":"INTEGER","values":[{"value":"50"}]}}}]}],"pages":[{"name":"fd3f0b99","displayName":"New Page","layout":[{"widget":{"name":"037fbfa3","queries":[{"name":"parameter_dashboards/01ef147d934d1545af7c4c1a131acf51/datasets/01ef147dca3f18ef85a0041c48b7fead_from_date","query":{"datasetName":"06c7f623","parameters":[{"name":"from_date","keyword":"from_date"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-single-select","encodings":{"fields":[{"parameterName":"from_date","queryName":"parameter_dashboards/01ef147d934d1545af7c4c1a131acf51/datasets/01ef147dca3f18ef85a0041c48b7fead_from_date"}]},"frame":{"showTitle":true,"title":"From"}}},"position":{"x":0,"y":0,"width":2,"height":1}},{"widget":{"name":"a89638db","queries":[{"name":"parameter_dashboards/01ef147d934d1545af7c4c1a131acf51/datasets/01ef147dca3f18ef85a0041c48b7fead_to_date","query":{"datasetName":"06c7f623","parameters":[{"name":"to_date","keyword":"to_date"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-single-select","encodings":{"fields":[{"parameterName":"to_date","queryName":"parameter_dashboards/01ef147d934d1545af7c4c1a131acf51/datasets/01ef147dca3f18ef85a0041c48b7fead_to_date"}]},"frame":{"showTitle":true,"title":"To"}}},"position":{"x":2,"y":0,"width":2,"height":1}},{"widget":{"name":"00a59c21","queries":[{"name":"main_query","query":{"datasetName":"06c7f623","fields":[{"name":"result_state","expression":"`result_state`"},{"name":"usage_minute","expression":"`usage_minute`"},{"name":"job_name","expression":"`job_name`"}],"disaggregated":true}}],"spec":{"version":3,"widgetType":"bar","encodings":{"x":{"fieldName":"usage_minute","scale":{"type":"categorical"},"displayName":"usage_minute"},"y":{"fieldName":"job_name","scale":{"type":"categorical"},"displayName":"job_name"},"color":{"fieldName":"result_state","scale":{"type":"categorical"},"legend":{"position":"bottom"},"displayName":"result_state"}},"frame":{"showTitle":true,"title":"Jobs Timeline"}}},"position":{"x":0,"y":1,"width":6,"height":28}},{"widget":{"name":"118c7ea2","queries":[{"name":"parameter_dashboards/01ef147d934d1545af7c4c1a131acf51/datasets/01ef147dca3f18ef85a0041c48b7fead_top_n","query":{"datasetName":"06c7f623","parameters":[{"name":"top_n","keyword":"top_n"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-single-select","encodings":{"fields":[{"parameterName":"top_n","queryName":"parameter_dashboards/01ef147d934d1545af7c4c1a131acf51/datasets/01ef147dca3f18ef85a0041c48b7fead_top_n"}]},"frame":{"showTitle":true,"title":"# jobs","showDescription":true,"description":"Based on # runs during time period"}}},"position":{"x":4,"y":0,"width":2,"height":1}}]}]}